diff -Napur APC-3.1.10//apc.php apc//apc.php
--- APC-3.1.10//apc.php	2012-04-11 13:46:33.000000000 +0200
+++ apc//apc.php	2012-06-12 08:26:50.172159560 +0200
@@ -22,7 +22,7 @@
 
  */
 
-$VERSION='$Id: apc.php 307048 2011-01-03 23:53:17Z kalle $';
+$VERSION='$Id: apc.php 325483 2012-05-01 00:34:04Z rasmus $';
 
 ////////// READ OPTIONAL CONFIGURATION FILE ////////////
 if (file_exists("apc.conf.php")) include("apc.conf.php");
@@ -91,7 +91,7 @@ $vardom=array(
 	'SORT1'	=> '/^[AHSMCDTZ]$/',	// first sort key
 	'SORT2'	=> '/^[DA]$/',			// second sort key
 	'AGGR'	=> '/^\d+$/',			// aggregation by dir level
-	'SEARCH'	=> '~^[a-zA-Z0-1/_.-]*$~'			// aggregation by dir level
+	'SEARCH'	=> '~^[a-zA-Z0-9/_.-]*$~'			// aggregation by dir level
 );
 
 // default cache mode
diff -Napur APC-3.1.10//apc_cache.c apc//apc_cache.c
--- APC-3.1.10//apc_cache.c	2012-04-11 13:46:33.000000000 +0200
+++ apc//apc_cache.c	2012-06-12 08:26:50.355159566 +0200
@@ -28,7 +28,7 @@
 
  */
 
-/* $Id: apc_cache.c 316725 2011-09-14 09:27:39Z pajoye $ */
+/* $Id: apc_cache.c 325482 2012-05-01 00:09:36Z rasmus $ */
 
 #include "apc_cache.h"
 #include "apc_zend.h"
@@ -944,7 +944,7 @@ int apc_cache_make_file_key(apc_cache_ke
 
     len = strlen(filename);
     if(APCG(fpstat)==0) {
-        if(IS_ABSOLUTE_PATH(filename,len)) {
+        if(IS_ABSOLUTE_PATH(filename,len) || strstr(filename, "://")) {
             key->data.fpfile.fullpath = filename;
             key->data.fpfile.fullpath_len = len;
             key->h = string_nhash_8(key->data.fpfile.fullpath, key->data.fpfile.fullpath_len);
diff -Napur APC-3.1.10//apc_string.c apc//apc_string.c
--- APC-3.1.10//apc_string.c	2012-04-11 13:46:33.000000000 +0200
+++ apc//apc_string.c	2012-06-12 08:26:50.167159560 +0200
@@ -25,7 +25,7 @@
 
  */
 
-/* $Id: apc_string.c 324142 2012-03-12 11:33:53Z pajoye $ */
+/* $Id: apc_string.c 326089 2012-06-11 04:29:57Z rasmus $ */
 
 #include "apc.h"
 #include "apc_globals.h"
@@ -91,17 +91,18 @@ const char *apc_new_interned_string(cons
         p = p->pNext;
     }
    
-    if (APCSG(interned_strings_top) + ZEND_MM_ALIGNED_SIZE(sizeof(Bucket) + nKeyLength) >=
+    if (APCSG(interned_strings_top) + ZEND_MM_ALIGNED_SIZE(sizeof(Bucket) + nKeyLength + 1) >=
         APCSG(interned_strings_end)) {
         /* no memory */
         return NULL;
     }
 
     p = (Bucket *) APCSG(interned_strings_top);
-    APCSG(interned_strings_top) += ZEND_MM_ALIGNED_SIZE(sizeof(Bucket) + nKeyLength);
+    APCSG(interned_strings_top) += ZEND_MM_ALIGNED_SIZE(sizeof(Bucket) + nKeyLength + 1);
 
     p->arKey = (char*)(p+1);
     memcpy(p->arKey, arKey, nKeyLength);
+    ((char *)p->arKey)[nKeyLength] = '\0';
     p->nKeyLength = nKeyLength;
     p->h = h;
     p->pData = &p->pDataPtr;
@@ -154,7 +155,7 @@ static void apc_copy_internal_strings(TS
         }
 
 		if (ce->name) {
-            ce->name = apc_new_interned_string(ce->name, ce->name_length TSRMLS_CC);
+            ce->name = apc_new_interned_string(ce->name, ce->name_length+1 TSRMLS_CC);
 		}
 
         q = ce->properties_info.pListHead;
@@ -166,7 +167,7 @@ static void apc_copy_internal_strings(TS
             }
 
             if (info->name) {
-                info->name = apc_new_interned_string(info->name, info->name_length TSRMLS_CC);
+                info->name = apc_new_interned_string(info->name, info->name_length+1 TSRMLS_CC);
             }
 
             q = q->pListNext;
diff -Napur APC-3.1.10//php_apc.c apc//php_apc.c
--- APC-3.1.10//php_apc.c	2012-04-11 13:46:33.000000000 +0200
+++ apc//php_apc.c	2012-06-12 08:26:50.183159560 +0200
@@ -26,7 +26,7 @@
 
  */
 
-/* $Id: php_apc.c 324326 2012-03-18 13:19:50Z pajoye $ */
+/* $Id: php_apc.c 325875 2012-05-27 17:15:26Z felipe $ */
 
 #include "apc_zend.h"
 #include "apc_cache.h"
@@ -317,7 +317,7 @@ static PHP_MINFO_FUNCTION(apc)
         php_info_print_table_row(2, "Serialization Support", "broken");
     }
 
-    php_info_print_table_row(2, "Revision", "$Revision: 324326 $");
+    php_info_print_table_row(2, "Revision", "$Revision: 325875 $");
     php_info_print_table_row(2, "Build Date", __DATE__ " " __TIME__);
     php_info_print_table_end();
     DISPLAY_INI_ENTRIES();
@@ -724,6 +724,10 @@ PHP_FUNCTION(apc_inc) {
     if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "s|lz", &strkey, &strkey_len, &(args.step), &success) == FAILURE) {
         return;
     }
+    
+	if (success) {
+		zval_dtor(success);
+	}
 
     if(_apc_update(strkey, strkey_len, inc_updater, &args TSRMLS_CC)) {
         if(success) ZVAL_TRUE(success);
@@ -747,6 +751,10 @@ PHP_FUNCTION(apc_dec) {
     if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "s|lz", &strkey, &strkey_len, &(args.step), &success) == FAILURE) {
         return;
     }
+    
+	if (success) {
+		zval_dtor(success);
+	}
 
     args.step = args.step * -1;
 
diff -Napur APC-3.1.10//php_apc.h apc//php_apc.h
--- APC-3.1.10//php_apc.h	2012-04-11 13:46:33.000000000 +0200
+++ apc//php_apc.h	2012-06-12 08:26:50.184159560 +0200
@@ -27,7 +27,7 @@
 
  */
 
-/* $Id: php_apc.h 311026 2011-05-14 22:09:47Z pajoye $ */
+/* $Id: php_apc.h 325044 2012-04-11 13:38:36Z pajoye $ */
 
 #ifndef PHP_APC_H
 #define PHP_APC_H
@@ -35,7 +35,7 @@
 #include "apc_php.h"
 #include "apc_globals.h"
 
-#define PHP_APC_VERSION "3.1.9"
+#define PHP_APC_VERSION "3.1.10"
 
 extern zend_module_entry apc_module_entry;
 #define apc_module_ptr &apc_module_entry
